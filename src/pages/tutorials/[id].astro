---
/**
 * Tutorial Detail Page - Public view for a single tutorial
 * Shows tutorial content with all sections
 * For authenticated users: shows completion status and CTA
 * Route: /tutorials/:id
 */

import Layout from "../../layouts/Layout.astro";
import { TutorialDetailView } from "../../components/tutorial-detail/TutorialDetailView";

// Read authenticated context from middleware-populated locals
const user = Astro.locals.user;
const profile = Astro.locals.profile;

// Derive props for TutorialDetailView
const isAuthenticated = !!user && !!profile;
const userSelectedLevel = profile?.selected_level;

// Get tutorial ID from URL params
const { id } = Astro.params;
const tutorialId = id ?? "";
---

<Layout title="Tutorial â€” Cook Mastery">
  <main class="container mx-auto w-full max-w-4xl px-4 py-6">
    <TutorialDetailView
      client:load
      tutorialId={tutorialId}
      isAuthenticated={isAuthenticated}
      userSelectedLevel={userSelectedLevel}
    />
  </main>
</Layout>
